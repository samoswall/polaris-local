# polaris-local
Polaris IQ Home devices integration to Home Assistant using the UDP protocol

## Описание
Это тестовый вариант интеграции.
Пока поддерживаются все чайники Polaris.
Работает с Облаком и приложением одновременно. Если включить mqtt, то соответственно с облаком больше не работает а одновременно с mqtt работает.

Что было сделано:
- Протокол "завернут" для работы в составе интеграции
- В интеграции теперь используется глобальный координатор
- Решена проблема восстановления соединения после обрыва связи (чайник поднят с подставки)
- Добавлен поиск новых устройств

С чем надо разобраться:
- Как разделить интеграцию на Полярис и Русклимат? Устройства обоих обнаруживаюся по одному имени _syncleo._udp.local
- Для добавления новых устройств надо исследовать как в протоколе упаковываюся данные (для переключателей только все понятно), надо смотреть логи, чтобы добавлять в протокол

## Как получить токен устройства Polaris
В приложении делимся устройством - сохраняем скриншот с QR кодом - сканируем скриншот любой программой - получаем текст вида:
`polaris://device-share/polaris/70/aabbccddeeff?token=111222333444555666777888999000ab&name=PUH-9105&attributes_appearance=9105`
где `111222333444555666777888999000ab` токен устройства (32 символа).

## Благодарности
Эта интеграция создана с использованием методов описанных в репозитории [polaris_pwk_1725cgld](https://github.com/gch1p/polaris_pwk_1725cgld).<br>
Спасибо автору [gch1p](https://github.com/gch1p).

